# This is a service to mount sysfs
foreground { echo "Starting oneshot service:  mount-sysfs" }

# Check if /sys exists and is a directory
ifelse -n { [ -d /sys ] }
{
  foreground { echo "/sys doesn't exist or isn't a directory! Aborting...\n\
(ERROR) Unable to start oneshot service:  mount-sysfs"
  }
  exit 1
}
# Check if the kernel supports sysfs
ifelse -n { grep -wq sysfs /proc/filesystems }
{
  foreground { echo "The kernel doesn't support sysfs! Aborting...\n\
(ERROR) Unable to start oneshot service:  mount-sysfs"
  }
  exit 1
}
# Check if sysfs is already mounted
if -t -n { grep -wq sysfs /proc/mounts }
mount -v sysfs /sys -n -t sysfs
