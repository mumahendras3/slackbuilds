##########################################
# This service sets the system's hostname
##########################################

foreground { echo "Starting oneshot service:  set-hostname" }
ifelse -n { [ -r /etc/HOSTNAME ] }
{
  # fall back on this old default:
  background {
    redirfd -w 1 /etc/HOSTNAME
    echo "darkstar.example.net"
  }
  hostname darkstar
}
pipeline { cut -f1 -d. /etc/HOSTNAME }
withstdinas -n HOSTNAME
importas -u hostname HOSTNAME
hostname $hostname
